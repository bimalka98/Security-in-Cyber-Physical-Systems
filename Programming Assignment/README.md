# Programming Assignment

## Requirements

* https://www.pycryptodome.org/src/introduction

```shell
# activate virtual environment

# install pycryptodome
(bees-collection) D:\Python39\bees-collection\Scripts>pip install pycryptodome
Collecting pycryptodome
  Downloading pycryptodome-3.18.0-cp35-abi3-win_amd64.whl (1.7 MB)
     |████████████████████████████████| 1.7 MB 66 kB/s
Installing collected packages: pycryptodome
Successfully installed pycryptodome-3.18.0
```

```shell
# error
.\activate : File D:\Python39\bees-collection\Scripts\activate.ps1 cannot be loaded because running scripts is disabled on this system. For more information, 
see about_Execution_Policies at https:/go.microsoft.com/fwlink/?LinkID=135170.
At line:1 char:1
+ .\activate bees-collection
+ ~~~~~~~~~~
    + CategoryInfo          : SecurityError: (:) [], PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess

# solution
PS D:\Python39\bees-collection\Scripts> Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

## Fucntion explanation

### `get_candidate_bf`

```python
def get_candidate_bf(counter, char_list):

    if counter == -1:
        return ''

    c = counter
    lc = len(char_list)
    candidate = []
    while c >= 0:
        idx = c % lc
        candidate.append(char_list[idx])
        c -= idx
        if c == 0:
            break
        c = int(c / lc)-1
    
    return ''.join(reversed(candidate)) 
```     


The `get_candidate_bf` function takes in two arguments: a counter value (`counter`) and a list of characters (`char_list`). The function is used to generate a password candidate based on the counter value and character list.

If the counter value is -1, the function returns an empty string. This is because the counter value is initialized to -1 in the `candidate_bf_generator` function, so the first password candidate generated by the generator will be an empty string.

If the counter value is not -1, the function enters a loop where it calculates the index of the character to append to the password candidate by taking the remainder of the counter value divided by the length of the character list (`idx = c % lc`). It then appends the character at this index to a list (`candidate.append(char_list[idx])`) and updates the counter value by subtracting the index and dividing by the length of the character list (`c = int(c / lc)-1`). This process is repeated until the counter value becomes 0 or negative.

Once the loop is exited, the final password candidate is obtained by reversing the list of characters (`reversed(candidate)`) and joining its elements into a string (`''.join(...)`). This password candidate is then returned by the function.

The logic behind this function is that it generates all possible combinations of characters in the character list up to a certain length. The counter value determines which combination of characters to generate. For example, if the character list is `['a', 'b', 'c']` and the maximum length is 2, then the first few password candidates generated by this function would be `''`, `'a'`, `'b'`, `'c'`, `'aa'`, `'ab'`, `'ac'`, `'ba'`, `'bb'`, `'bc'`, `'ca'`, `'cb'`, and `'cc'`.

## `reduce_family`

```python
def reduce_family(i, hash_hex, length):
    char_list = 'abcdefghijklmnopqrstuvwxyz0123456789'

    assert len(hash_hex) >= 2*length

    hash_bytes = list(bytearray(binascii.unhexlify(hash_hex)))
    random.Random(i).shuffle(hash_bytes)

    l = length
    for i in range(0, length):
        if (hash_bytes[-(1+i)] % len(char_list)) == 0:
            l -= 1
        else:
            break

    res = []
    for j in range(0, l):
        idx = hash_bytes[j] % len(char_list)
        res.append(char_list[idx])
    return ''.join(res)
```    

This is a Python function that defines a family of reduction functions for use in a rainbow table. The function takes three arguments: `i`, `hash_hex`, and `length`.

`i` is an index that specifies which reduction function to use from the family of reduction functions.

`hash_hex` is a hexadecimal representation of the hash value to be reduced.

`length` is the desired length of the output of the reduction function.

The function first converts the hexadecimal hash value into a list of bytes and shuffles them using a random number generator seeded with the index `i`. This ensures that different reduction functions in the family produce different outputs for the same input hash value.

Next, the function determines the length of the output by counting the number of trailing zeros in the list of bytes modulo the length of the character set. The length of the output is then adjusted accordingly.

Finally, the function generates the output by selecting characters from a predefined character set (`char_list`) based on the values of the first `l` bytes in the shuffled list of bytes. The selected characters are appended to a list, which is then joined into a string and returned as the result.

```
Type of the lookup table: <class 'dict'>
Length of the lookup table: 5
{'9g5i': [{'chain': 1, 'end': '9g5i', 'start': 'ex2b'}], 
'mrh8': [{'chain': 4, 'end': 'mrh8', 'start': 'ltzw'}], 
'no7e': [{'chain': 0, 'end': 'no7e', 'start': 'r7hm'}], 
'qn9e': [{'chain': 2, 'end': 'qn9e', 'start': '8i89'}], 
'xhxq': [{'chain': 3, 'end': 'xhxq', 'start': '6tnf'}]}

```